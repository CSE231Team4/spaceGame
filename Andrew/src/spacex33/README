This is the latest code with my reflected changes and bug fixes included
